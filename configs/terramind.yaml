defaults:
  - base
  - _self_

model:
  _target_: mod_res_damage.models.terramind.TerramindBayeSiamNet
  num_classes: 4
  finetune: false
  output_layers: [1, 3, 5, 7, 11]

dataset:
  _target_: mod_res_damage.datasets.mbright.ModifiedBright
  root_path: ${hydra:runtime.cwd}/data/mbright
  input_size: 224
  cache_arrays: true
  augment: 64
  holdout: [ukraine-conflict]

trainer:
  _target_: mod_res_damage.trainers.Trainer
  n_epochs: 1024
  ckpt_interval: 128
  eval_interval: 32
  log_interval: 1
  best_metric_key: 'mIoU'
  precision: fp32

optimizer:
  _target_: torch.optim.AdamW
  lr: 0.0001
  weight_decay: 0.0001
  betas: [0.9, 0.999]

lr_scheduler:
  _target_: torch.optim.lr_scheduler.CosineAnnealingLR
  T_max: 128
  last_epoch: -1

criterion:
  _target_: torch.nn.CrossEntropyLoss

activation:
  _target_: torch.nn.Softmax
  dim: 1

evaluator:
  _target_: mod_res_damage.evaluators.SegEvaluator
  inference_mode: sliding
  inference_batch: 16
  num_monte_carlo: 128
  save_probs: true
  
use_wandb: true
num_workers: 2
use_final_ckpt: true
find_unused_parameters: false
pin_memory: true
persistent_workers: false

train_batch_size: 16
test_batch_size: 1

